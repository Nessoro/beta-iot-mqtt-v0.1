<html>
 <head>
<link rel="stylesheet" href="style.css" type="text/css"/>
<script src="script.js"></script>
</head>
 <body>
<div id="container"> 
  <div id="left">
Сайт для управления освещением и воздухообменом на предприятии  <br><br>
 

<button id="btn" onclick="Connect()"> Подключение </button>

<button id="door" style="display: none;" onclick="openF()">Включить / Отключить свет</button>
<button id="getTemp" style="display: none;" onclick="Temp()">Текущая температура</button>
<button id="pushRelay" style="display: none;" onclick="pushR()">Питание реле</button>
<button id="getHumidity" style="display: none;" onclick="getH()">Влажность</button>
<button id="motionSensor" style="display: none;" onclick="checkMotion()">Датчик движения</button>
<button id="lightSensor" style="display: none;" onclick="checkLight()">Датчик освещенния</button>


<div id="mqttMess">Журнал MQTT-сообщений: </div>
<div id="text"></div>
</div> 
</div>

 <script>
var text_div = document.getElementById("text");
var connectButton = document.getElementById("btn");
var doorButton = document.getElementById("door")
var relayButton = document.getElementById("pushRelay");
var motionSensorButton = document.getElementById("motionSensor");
var lightSensorButton = document.getElementById("lightSensor");
var fixLightButton = document.getElementById("fixLight");

	var motionDetected = false;
	var lightDetected = false;

    		var criticalLightValue = 200; // Критическое значение освещенние
    		var currentLightValue = 0; // Текущее значение освещенние



function Connect() {
  text_div.innerHTML = 'Подключение. . .';
  connectButton.innerHTML = 'Подключено';
  connectButton.disabled = true; // Делаем кнопку неактивной
  
// Имитация задержки для операции подключения
  setTimeout(function() {
  text_div.innerHTML = 'Подключено';

    // После успешного подключения, отображаем другие кнопки
    document.getElementById("door").style.display = "inline-block";
    document.getElementById("getTemp").style.display = "inline-block";
    document.getElementById("pushRelay").style.display = "inline-block";
    document.getElementById("getHumidity").style.display = "inline-block";
    document.getElementById("motionSensor").style.display = "inline-block";
    lightSensorButton.style = "inline-block";
    fixLightButton.style = "inline-block";
  }, 3000);
}

function openF() {
  doorButton.innerHTML = 'Включен';
  doorButton.disabled = true;	
  text_div.innerHTML = 'Включить <button onclick="closeF()">Отключить</button>';
}

function closeF() {
  doorButton.innerHTML = 'Выключен';
  doorButton.disabled = true;
  text_div.innerHTML = 'Отключить <button onclick="openF()">Включить</button>';
}

function Temp() {
  var minTemp = 18; // Минимальная температура (в градусах Цельсия)
  var maxTemp = 24; // Максимальная температура (в градусах Цельсия)
  var randomTemp = Math.floor(Math.random() * (maxTemp - minTemp + 1)) + minTemp;
  text_div.innerHTML = 'Текущая температура - ' + randomTemp + '°';
}


function pushR() {
  text_div.innerHTML = 'Включено';
  relayButton.innerHTML = 'Включено';
  relayButton.disabled = true; // Делаем кнопку "Питание реле" неактивной
}

function getH() {
  var minHumidity = 40; // Минимальная влажность (в процентах)
  var maxHumidity = 60; // Максимальная влажность (в процентах)
  var randomHumidity = Math.floor(Math.random() * (maxHumidity - minHumidity + 1)) + minHumidity;
  text_div.innerHTML = 'Влажность - ' + randomHumidity + '%';
}

function checkMotion() {
       motionSensorButton.innerHTML = 'Датчик движения (активен, недоступен)';
      motionSensorButton.disabled = true;
    }

function checkLight() {
      currentLightValue = Math.floor(Math.random() * 500); // Генерируем случайное значение освещенности
      lightSensorButton.innerHTML = 'Освещенние: ' + currentLightValue;

      if (currentLightValue < criticalLightValue) {
        text_div.innerHTML = 'Критическая значение освещенние! <button onclick="fixLight()">Исправить</button>';
	fixLightButton.disabled = false;
      } else {
        text_div.innerHTML = 'Освещенние в норме';
	lightSensorButton.disabled = true;
      }
    }

    function fixLight() {
      currentLightValue = 400; // Исправляем освещенние
      lightSensorButton.innerHTML = 'Освещенние: ' + currentLightValue;
      text_div.innerHTML = 'Освещенние восстановлена';
      fixLightButton.disabled = true;
    }

 </script>
<br><br>


 <div id="FIO">
 <br><br>
 <br><br>
 <br><br>
 <br><br>
 Ильяс Жамалетдинов М3О-125М-23<br><br>
 </div>
  <title>ISECALE</title>
  <style>
   body {
     background: url(https://wallpaperaccess.com/full/2367881.jpg)
    }
   </body>
  </html>
